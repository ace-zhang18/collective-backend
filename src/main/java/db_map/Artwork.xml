<?xml version = "1.0" encoding = "UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace = "Artwork">

   <insert id = "insert" parameterType = "Artwork">
      	INSERT INTO artworks (artwork_id, owners, permissions, title, history, sale, tags, file_type) 
      	VALUES (#{artwork_id}, #{owners}, #{permissions}, #{title}, #{history}, #{sale}, #{tags}, #{file_type});
	</insert> 
	
	<update id = "update" parameterType = "Artwork">
    	UPDATE artworks SET owners = #{owners}, permissions = #{permissions}, history = #{history},
    	content = #{content}, sale = #{sale}, tags = #{tags}, file_type = #{file_type}
    	WHERE artwork_id = #{artwork_id};
	</update>
    
    <delete id = "delete" parameterType = "long">
    	DELETE FROM artworks WHERE artwork_id = #{artwork_id}
    </delete>
    
    <select id="get" parameterType = "long" resultMap="artworkMap">
    	SELECT * FROM artworks where artwork_ID = #{artwork_id};
	</select>
	
	<select id="getIDs" resultType="long">
    	SELECT artwork_id FROM artworks ORDER BY artwork_id ASC;
	</select>
    
    <select id="getByTitle" parameterType = "String" resultMap="artworkMap">
    	SELECT * FROM artworks where title = #{title};
	</select>
    	
	<select id="getAll" resultMap="artworkMap">
    	SELECT * FROM artworks
	</select>
    
	<resultMap id = "artworkMap" type = "Artwork">
		<result property = "artwork_id" column = "ARTWORK_ID"/>
		<result property = "owners" column = "OWNERS" javaType="org.postgresql.util.PGobject" typeHandler="handlers.PGObjectTypeHandler"/>
		<result property = "metadata" column = "METADATA" javaType="org.postgresql.util.PGobject" typeHandler="handlers.PGObjectTypeHandler"/>	
		<result property = "permissions" column = "PERMISSIONS" javaType="org.postgresql.util.PGobject" typeHandler="handlers.PGObjectTypeHandler"/>
		<result property = "history" column = "HISTORY" javaType="org.postgresql.util.PGobject" typeHandler="handlers.PGObjectTypeHandler"/>
		<result property = "sale" column = "SALE" typeHandler="handlers.PGObjectArrayTypeHandler"/>
		<result property = "tags" column = "TAGS" typeHandler="handlers.LongArrayTypeHandler"/>	
		<result property = "file_type" column = "FILE_TYPE"/>
	</resultMap>

	
</mapper>