<?xml version = "1.0" encoding = "UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace = "User">

   <insert id = "insert" parameterType = "User">
      	INSERT INTO Users (USERNAME, STAFF_ROLES, trade_roles, icon_url, settings, profile_card, profile_page, join_date, login_history, social_media, payment_info, custom_url) 
      	VALUES ( #{username}, #{staff_roles}, #{trade_roles}, #{icon_url}, #{settings#}, #{profile_card}, #{profile_page}, #{join_date}, #{login_history}, #{social_media}, #{payment_info}, #{custom_url})   
	</insert> 
	
	<update id = "update" parameterType = "User">
    	UPDATE Users SET username = #{username}, staff_roles = #{staff_roles}, trade_roles = #{trade_roles}, icon_url = #{icon_url}, 
    	settings = #{settings}, profile_card = #{profile_card}, profile_page = #{profile_page}, join_date = #{join_date}, 
    	login_history = #{login_history}, social_media = #{social_media}, payment_info = #{payment_info}, custom_url = #{custom_url}
    	WHERE USER_ID = #{user_id}
	</update>

    <delete id = "delete" parameterType = "long">
    	DELETE FROM users WHERE user_id= #{user_id}
    </delete>

    <select id="get" parameterType = "long" resultMap="userMap">
    	SELECT * FROM users WHERE USER_ID = #{user_id}
	</select>
    	
	<select id="getAll" resultMap="userMap">
    	SELECT * FROM users ORDER BY user_id ASC;
	</select>
    
	<resultMap id = "userMap" type = "User">
   		<result property = "user_id" column = "USER_ID"/>
		<result property = "username" column = "USERNAME"/>
		<result property = "icon_url" column = "ICON_URL"/>
		<result property = "profile_card" column = "PROFILE_CARD"/>
		<result property = "profile_page" column = "PROFILE_PAGE"/>
		<result property = "custom_url" column = "CUSTOM_URL"/>
		<result property = "staff_roles" column = "STAFF_ROLES" typeHandler="handlers.LongArrayTypeHandler"/>
		<result property = "trade_roles" column = "TRADE_ROLES" typeHandler="handlers.LongArrayTypeHandler"/>
		<result property = "settings" column = "SETTINGS" javaType="org.postgresql.util.PGobject" typeHandler="handlers.PGObjectTypeHandler"/>		
		<result property = "social_media" column = "SOCIAL_MEDIA" javaType="org.postgresql.util.PGobject" typeHandler="handlers.PGObjectTypeHandler"/>
		<result property = "payment_info" column = "PAYMENT_INFO" javaType="org.postgresql.util.PGobject" typeHandler="handlers.PGObjectTypeHandler"/>
		<result property = "login_history" column = "LOGIN_HISTORY" typeHandler="handlers.PGObjectArrayTypeHandler"/>
		<result property = "join_date" column = "JOIN_DATE"/>
	</resultMap>
</mapper>