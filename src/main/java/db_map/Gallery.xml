<?xml version = "1.0" encoding = "UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace = "Gallery">

   <insert id = "insert" parameterType = "Gallery">
      	INSERT INTO galleries (gallery_id, cover, title, collection, tags, permissions, history, owners, sale) 
      	VALUES (#{gallery_id}, #{cover}, #{title}, #{collection}, #{tags}, #{permissions}, #{history}, #{owners}, #{sale});
	</insert> 
	
	<update id = "update" parameterType = "Gallery">
    	UPDATE galleries SET cover = #{cover}, title = #{title}, collection = #{collection}, tags = #{tags}, 
    	permissions = #{permissions}, history = #{history}, owners = #{owners}, sale = #{sale}
    	WHERE gallery_id = #{gallery_id};
	</update>
    
	<delete id = "delete" parameterType = "long">
    	DELETE FROM galleries WHERE gallery_id = #{gallery_id};
    </delete>
    
    <select id="get" parameterType = "long" resultMap="galleryMap">
    	SELECT * FROM galleries WHERE gallery_id = #{gallery_id};
	</select>
    
	<select id="getAll" resultMap="galleryMap">
    	SELECT * FROM galleries;
	</select>
    
	<resultMap id = "galleryMap" type = "Gallery">
		<result property = "gallery_id" column = "GALLERY_ID"/>
		<result property = "cover" column = "COVER"/>
		<result property = "title" column = "TITLE"/>
		<result property = "collection" column = "COLLECTION" typeHandler="handlers.LongArrayTypeHandler"/>
		<result property = "tags" column = "TAGS" typeHandler="handlers.LongArrayTypeHandler"/>
		<result property = "permissions" column = "PERMISSIONS" javaType="org.postgresql.util.PGobject" typeHandler="handlers.PGObjectTypeHandler"/>
		<result property = "history" column = "HISTORY" javaType="org.postgresql.util.PGobject" typeHandler="handlers.PGObjectTypeHandler"/>
		<result property = "owners" column = "OWNERS" javaType="org.postgresql.util.PGobject" typeHandler="handlers.PGObjectTypeHandler"/>	
		<result property = "sale" column = "SALE" typeHandler="handlers.PGObjectArrayTypeHandler"/>
	</resultMap>

	
</mapper>